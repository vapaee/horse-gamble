<div class="transfer-form">
    <button (click)="viewState = 'success'">Simulate Success</button>
    <button (click)="viewState = 'failure'">Simulate Failure</button>
    <button (click)="viewState = 'form'">Simulate Form</button>

    <!-- Form View -->
    <div *ngIf="viewState === 'form'">
        <div class="container-available">
            <p class="small">Available:</p>
            <strong>{{ balance.amount.formatted }} {{ balance.token.symbol }}</strong>
        </div>

        <form [formGroup]="form" (ngSubmit)="transfer()">
            <!-- Recipient Input -->
            <div class="container-input">
                <label class="small" for="recipient">Transfer to:</label>
                <input id="recipient" type="text" formControlName="recipient" placeholder="Enter EOSIO username" />

                <p *ngIf="form.get('recipient')?.value" class="small">
                    <span *ngIf="form.get('recipient')?.pending" class="checking">⏳ Checking account...</span>
                    <span *ngIf="form.get('recipient')?.errors?.['pattern']" class="invalid">❌ Wrong EOSIO pattern, 1-12 characters (a-z, 1-5)</span>
                    <span *ngIf="form.get('recipient')?.errors?.['selfTransfer']" class="invalid">❌ Cannot send tokens to yourself</span>
                    <span *ngIf="form.get('recipient')?.errors?.['accountNotFound']" class="invalid">❌ Account does not exist</span>
                    <span *ngIf="form.get('recipient')?.valid && !form.get('recipient')?.pending" class="valid">✅ Verified Account</span>
                </p>
            </div>

            <!-- Amount Input -->
            <div class="container-input">
                <div class="bar">
                    <label class="small" for="amount">Amount:</label>
                    <a *ngIf="!isMaxAmount()" class="small max" (click)="useMax()">Use Max</a>
                </div>
                <input id="amount" type="text" formControlName="amount" placeholder="Enter whole number" autocomplete="off" />

                <p *ngIf="form.get('amount')?.value !== null" class="small">
                    <span *ngIf="form.get('amount')?.errors?.['invalidAmount']" class="invalid">❌ Invalid amount</span>
                    <span *ngIf="form.get('amount')?.errors?.['outOfBalance']" class="invalid">❌ Amount exceeds balance</span>
                    <span *ngIf="form.get('amount')?.valid" class="valid">✅ Amount is within balance</span>
                </p>
            </div>

            <!-- Transfer Button -->
            <div class="container-transfer">
                <br>
                <button [class]="form.valid ? 'btn2' : 'unable'" type="submit" [disabled]="form.invalid || isLoading">
                    {{ isLoading ? 'Processing...' : 'Transfer' }}
                </button>
            </div>
        </form>
    </div>

    <!-- Success View -->
    <div *ngIf="viewState === 'success'" class="result-view success">
        <p class="message">✅ Transfer Successful!</p>
        <button (click)="viewState = 'form'">Back to Form</button>
    </div>

    <!-- Failure View -->
    <div *ngIf="viewState === 'failure'" class="result-view failure">
        <p class="message">❌ Transfer Failed</p>
        <button (click)="viewState = 'form'">Back to Form</button>
    </div>
</div>
