<div class="transfer-form">
    <!-- Available Balance Display -->
    <div class="container-available">
        <p class="small">Available:</p>
        <strong>{{ balance.amount.formatted }} {{ balance.token.symbol }}</strong>
    </div>

    <div class="container-input">
        <label class="small" for="recipient">Transfer to:</label>
        <input
            id="recipient"
            type="text"
            [(ngModel)]="recipient"
            (input)="onRecipientChange()"
            placeholder="Enter EOSIO username"
        />

        <p *ngIf="recipient" class="small">
            <!-- Case 1: Pattern Mismatch -->
            <span *ngIf="!isCheckingRecipient && !isRecipientPatternValid" class="invalid">
                ❌ Wrong EOSIO pattern, 1-12 characters (a-z, 1-5)
            </span>

            <!-- Case 2: Sending to Self -->
            <span *ngIf="!isCheckingRecipient && isRecipientPatternValid && isSelfTransfer" class="invalid">
                ❌ Cannot send tokens to yourself
            </span>

            <!-- Case 3: Checking if Account Exists -->
            <span *ngIf="isCheckingRecipient" class="checking">
                ⏳ Checking account...
            </span>

            <!-- Case 4: Verified Account -->
            <span *ngIf="!isCheckingRecipient && isRecipientValid" class="valid">
                ✅ Verified Account
            </span>

            <!-- Case 5: Account Not Found (Only show if it's NOT a self-transfer) -->
            <span *ngIf="!isCheckingRecipient && !isRecipientValid && isRecipientPatternValid && !isSelfTransfer" class="invalid">
                ❌ Account does not exist
            </span>
        </p>

        <label class="small" for="amount">Amount:</label>
        <input
            id="amount"
            type="number"
            [(ngModel)]="amount"
            (input)="onAmountChange()"
            placeholder="Enter whole number"
            min="0"
            step="1"
            autocomplete="off"
        />
        <p *ngIf="amount !== null" class="small" [ngClass]="isAmountValid ? 'valid' : 'invalid'">
            {{ isAmountValid ? '✅ Amount is within balance' : '❌ Invalid amount'}}
        </p>
    </div>

    <!-- Transfer Button -->
    <div class="container-transfer">
        <br>
        <button
            [class]="isRecipientValid && isAmountValid ? 'btn2' : 'unable'"
            (click)="transfer()"
            [disabled]="!isRecipientValid || !isAmountValid || isLoading"
        >
            {{ isLoading ? 'Processing...' : 'Transfer' }}
        </button>
    </div>
</div>
